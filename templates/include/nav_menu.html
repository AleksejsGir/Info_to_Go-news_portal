<!-- templates/include/nav_menu.html -->
<ul class="navbar-nav me-auto">
    {% for item in menu %}
        <li class="nav-item">
            <a class="nav-link" href="{% url item.url_name %}">
                {% if item.title == 'Главная' %}
                    <i class="bi bi-house-door me-1"></i>
                {% elif item.title == 'О проекте' %}
                    <i class="bi bi-info-circle me-1"></i>
                {% elif item.title == 'Каталог' %}
                    <i class="bi bi-grid me-1"></i>
                {% endif %}
                {{ item.title }}
            </a>
        </li>
        {% if not forloop.last %}
            <li class="nav-item"><hr class="dropdown-divider"/></li>
        {% endif %}
    {% endfor %}

    <!-- Разделитель перед пунктом "Избранное" -->
    <li class="nav-item"><hr class="dropdown-divider"/></li>

    <!-- Пункт "Избранное" -->
    <li class="nav-item">
        <a class="nav-link {% if is_favorites_page %}active{% endif %}" href="{% url 'news:favorite_news' %}">
            <i class="bi bi-bookmark me-1"></i> Избранное
        </a>
    </li>

    <!-- Добавляем пункт "Добавить статью" -->
    <li class="nav-item">
        <a class="nav-link" href="{% url 'news:add_article' %}">
            <i class="bi bi-plus-circle me-1"></i> Добавить статью
        </a>
    </li>
    <!-- Пункт "Загрузить из JSON" -->
    <li class="nav-item">
       <a class="nav-link" href="{% url 'news:upload_json' %}">
           <i class="bi bi-upload me-1"></i> Загрузить из JSON
      </a>
   </li>

   <!-- Добавляем разделитель и пункт для входа/выхода -->
    {% if user.is_authenticated %}
    <!-- Если пользователь авторизован - показываем выпадающее меню пользователя -->
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-person-circle me-1"></i> {{ user.username }}
        </a>
        <ul class="dropdown-menu" aria-labelledby="userDropdown">
            <li>
                <a class="dropdown-item" href="{% url 'account_email' %}">
                    <i class="bi bi-envelope me-2"></i>Управление Email
                </a>
            </li>
            <li>
                <a class="dropdown-item" href="{% url 'account_change_password' %}">
                    <i class="bi bi-key me-2"></i>Изменить пароль
                </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
                <form method="post" action="{% url 'account_logout' %}" class="m-0 p-0">
                    {% csrf_token %}
                    <button type="submit" class="dropdown-item">
                        <i class="bi bi-box-arrow-right me-2"></i>Выход
                    </button>
                </form>
            </li>
        </ul>
    </li>
    {% else %}
    <!-- Если пользователь не авторизован - показываем кнопки входа и регистрации -->
    <li class="nav-item">
        <a class="nav-link" href="{% url 'account_login' %}">
            <i class="bi bi-box-arrow-in-right me-1"></i> Вход
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'account_signup' %}">
            <i class="bi bi-person-plus me-1"></i> Регистрация
        </a>
    </li>
    {% endif %}
</ul>