{% extends 'base.html' %}

{% block title %}Info to Go - Главная страница{% endblock %}

{% block content %}
<div class="main-page-container">
    <!-- Приветственный заголовок -->
    <div class="welcome-section text-center mb-4">
        <h1>Добро пожаловать на Info to Go</h1>
        <p class="lead">Ваш источник актуальных новостей из мира технологий, автомобилей и многого другого</p>
        <div class="stats-container">
            <span class="badge bg-primary">Новостей: {{ news_count }}</span>
            <span class="badge bg-info">Пользователей: {{ users_count }}</span>
        </div>
    </div>

    <!-- Секция "Главные новости" (карусель) -->
    <div class="featured-news-section mb-5">
        <h2 class="section-title"><i class="bi bi-star-fill text-warning me-2"></i>Главные новости</h2>
        <div id="featuredCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                {% for article in featured_articles %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <div class="featured-article-card">
                            {% if article.image %}
                                <img src="{{ article.image.url }}" class="featured-article-image" alt="{{ article.title }}">
                            {% else %}
                                <div class="featured-article-placeholder">
                                    <i class="bi bi-newspaper"></i>
                                </div>
                            {% endif %}
                            <div class="featured-article-content">
                                <h3>{{ article.title }}</h3>
                                <p>{{ article.content|truncatewords:30 }}</p>
                                <div class="article-meta">
                                    <span class="category-badge">{{ article.category.name }}</span>
                                    <span class="date-badge">{{ article.publication_date|date:"d.m.Y" }}</span>
                                </div>
                                <a href="{% url 'news:detail_article_by_id' article.id %}" class="btn btn-primary">Читать далее</a>
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <div class="carousel-item active">
                        <div class="featured-article-card">
                            <div class="text-center p-5">
                                <h3>Скоро здесь появятся главные новости!</h3>
                                <p>Следите за обновлениями сайта</p>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#featuredCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#featuredCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>

    <!-- Секция "Последние новости" -->
    <div class="latest-news-section mb-5">
        <h2 class="section-title"><i class="bi bi-clock-history me-2"></i>Последние новости</h2>
        <div class="row">
            {% for article in latest_articles %}
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        {% if article.image %}
                            <img src="{{ article.image.url }}" class="card-img-top" alt="{{ article.title }}">
                        {% else %}
                            <div class="article-placeholder">
                                <i class="bi bi-file-text"></i>
                            </div>
                        {% endif %}
                        <div class="card-body">
                            <span class="badge bg-secondary mb-2">{{ article.category.name }}</span>
                            <h5 class="card-title">{{ article.title }}</h5>
                            <p class="card-text">{{ article.content|truncatewords:15 }}</p>
                        </div>
                        <div class="card-footer">
                            <small class="text-muted">{{ article.publication_date|date:"d.m.Y H:i" }}</small>
                            <a href="{% url 'news:detail_article_by_id' article.id %}" class="btn btn-sm btn-outline-primary float-end">Читать</a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="col-12">
                    <div class="alert alert-info">
                        Новости скоро появятся. Заходите позже!
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="text-center mt-3">
            <a href="{% url 'news:catalog' %}" class="btn btn-outline-primary">Смотреть все новости</a>
        </div>
    </div>

    <!-- Секция "Популярные категории" -->
    <div class="popular-categories-section mb-5">
        <h2 class="section-title"><i class="bi bi-grid-3x3-gap me-2"></i>Популярные категории</h2>
        <div class="row">
            {% for category, articles in category_articles.items %}
                {% if articles %}
                    <div class="col-md-6 mb-4">
                        <div class="category-card">
                            <h3 class="category-title">{{ category.name }}</h3>
                            <ul class="list-group list-group-flush">
                                {% for article in articles|slice:":3" %}
                                    <li class="list-group-item">
                                        <a href="{% url 'news:detail_article_by_id' article.id %}" class="text-decoration-none">
                                            {{ article.title }}
                                        </a>
                                        <small class="text-muted ms-2">{{ article.publication_date|date:"d.m.Y" }}</small>
                                    </li>
                                {% endfor %}
                            </ul>
                            <div class="text-end mt-2">
                                <a href="{% url 'news:news_by_category' category.id %}" class="btn btn-sm btn-outline-secondary">
                                    Все новости категории
                                </a>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% empty %}
                <div class="col-12">
                    <div class="alert alert-info">
                        Скоро здесь появятся категории с актуальными новостями!
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Секция "Самое популярное" -->
    <div class="most-viewed-section mb-4">
        <h2 class="section-title"><i class="bi bi-graph-up me-2"></i>Самое популярное</h2>
        <div class="row">
            {% for article in most_viewed_articles %}
                <div class="col-lg-3 col-md-6 mb-3">
                    <div class="popular-article-card">
                        <div class="views-badge">
                            <i class="bi bi-eye"></i> {{ article.views }}
                        </div>
                        <h5 class="mt-2">{{ article.title }}</h5>
                        <span class="category-name">{{ article.category.name }}</span>
                        <div class="mt-2">
                            <a href="{% url 'news:detail_article_by_id' article.id %}" class="btn btn-sm btn-link">Подробнее</a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="col-12">
                    <div class="alert alert-info">
                        Пока нет популярных статей. Станьте первым читателем!
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}